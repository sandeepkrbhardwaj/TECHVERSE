<!DOCTYPE html>
<html lang="en">
<head>
  <!-- ================= META ================= -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Techverse | Dashboard</title>

  <!-- ================= STYLES ================= -->
  <style>
    *{
      margin:0;
      padding:0;
      box-sizing:border-box;
      font-family: Arial, sans-serif;
    }

    body{
      background:#f4f6fb;
      overflow:hidden;
    }

    header{
      position:fixed;
      top:0; left:0; right:0;
      height:64px;
      background:linear-gradient(135deg,#071833,#0b2b5a);
      color:#fff;
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:0 20px;
      z-index:1000;
    }

    .brand{
      display:flex;
      align-items:center;
      gap:12px;
      font-size:20px;
      font-weight:700;
    }

    .brand img{
      height:40px;
      border-radius:8px;
    }

    .toggle-btn{
      background:none;
      border:none;
      color:#fff;
      font-size:22px;
      cursor:pointer;
    }

    .search-wrap{
      flex:1;
      display:flex;
      justify-content:center;
    }

    .search-box{
      width:520px;
      max-width:90%;
    }

    .search-box input{
      width:100%;
      padding:10px 14px;
      border-radius:10px;
      border:none;
      outline:none;
      font-size:14px;
    }

    .right{
      display:flex;
      align-items:center;
      gap:22px;
    }

    .notif-btn{
      background:none;
      border:none;
      font-size:20px;
      cursor:pointer;
      position:relative;
      color:#fff;
    }

    .badge{
      position:absolute;
      top:-4px;
      right:-8px;
      background:#ff3b30;
      color:#fff;
      font-size:11px;
      padding:2px 6px;
      border-radius:999px;
    }

    .profile{
      display:flex;
      align-items:center;
      gap:8px;
      cursor:pointer;
      position:relative;
    }

    .avatar{
      width:34px;
      height:34px;
      border-radius:50%;
      object-fit:cover;
      border:2px solid #fff;
    }

    .dropdown{
      position:absolute;
      top:54px;
      right:0;
      background:#ffffff;
      min-width:190px;
      border-radius:10px;
      box-shadow:0 12px 30px rgba(0,0,0,0.18);
      display:none;
      overflow:hidden;
    }

    .dropdown a{
      display:block;
      padding:12px 14px;
      text-decoration:none;
      color:#111827;
      font-size:14px;
    }

    .dropdown a:hover{
      background:#f1f5f9;
    }

    .sidebar{
      position:fixed;
      top:64px;
      left:0;
      bottom:0;
      width:240px;
      background:#0f2a4d;
      padding:14px;
      transition:width 0.3s ease;
      overflow:hidden;
    }

    .sidebar.collapsed{
      width:72px;
    }

    .sidebar a{
      display:flex;
      align-items:center;
      gap:14px;
      padding:12px;
      margin-bottom:8px;
      color:#e5e7eb;
      text-decoration:none;
      border-radius:10px;
      transition:0.25s;
      white-space:nowrap;
      font-size:15px;
    }

    .sidebar a span{
      transition:opacity 0.2s;
    }

    .sidebar.collapsed a span{
      opacity:0;
    }

    .sidebar a:hover,
    .sidebar a.active{
      background:#071833;
      color:#fff;
    }

    .content{
      margin-left:240px;
      margin-top:64px;
      height:calc(100vh - 64px);
      transition:margin-left 0.3s ease;
      background:#f4f6fb;
    }

    .content.collapsed{
      margin-left:72px;
    }

    iframe{
      width:100%;
      height:100%;
      border:none;
      background:#fff;
    }

    @media(max-width:768px){
      .sidebar{ width:0; }
      .content{ margin-left:0; }
      .search-wrap{ display:none; }
    }
  </style>
</head>

<body>

<header>
  <div class="brand">
    <button id="toggleSidebar" class="toggle-btn">‚ò∞</button>
    <img src="logo.jpeg" alt="logo">
    Techverse
  </div>

  <div class="search-wrap">
    <div class="search-box">
      <input type="search" placeholder="Search courses, topics, mentors...">
    </div>
  </div>

  <div class="right">
    <button id="notifBtn" class="notif-btn">
      üîî <span class="badge" id="notifCount">3</span>
    </button>

    <div id="profileBtn" class="profile">
      <img src="profile.jpg" class="avatar" alt="profile">
      <div id="profileMenu" class="dropdown">
        <a href="profile.html" target="mainFrame">View Profile</a>
        <a href="help.html" target="mainFrame">Help & Support</a>
        <a href="#" id="logoutLink">Logout</a>
      </div>
    </div>
  </div>
</header>

<nav id="sidebar" class="sidebar">
  <a href="home.html" target="mainFrame" class="nav-link active">üè† <span>Home</span></a>
  <a href="language.html" target="mainFrame" class="nav-link">üíª <span>Languages</span></a>
  <a href="development.html" target="mainFrame" class="nav-link">üõ† <span>Development</span></a>
  <a href="quick learning.html" target="mainFrame" class="nav-link">‚ö° <span>Quick Learning</span></a>
  <a href="exchange.html" target="mainFrame" class="nav-link">üîÅ <span>Exchange</span></a>
  <a href="reward.html" target="mainFrame" class="nav-link">üèÜ <span>Rewards</span></a>
  <a href="feedback.html" target="mainFrame" class="nav-link">
  üìù <span>Feedback</span>
</a>

</nav>

<div id="content" class="content">
  <iframe name="mainFrame" src="home.html"></iframe>
</div>

<script>
const sidebar = document.getElementById("sidebar");
const content = document.getElementById("content");
const toggleBtn = document.getElementById("toggleSidebar");
const profileBtn = document.getElementById("profileBtn");
const profileMenu = document.getElementById("profileMenu");

toggleBtn.onclick = () => {
  sidebar.classList.toggle("collapsed");
  content.classList.toggle("collapsed");
};

document.querySelectorAll(".nav-link").forEach(link=>{
  link.onclick = ()=>{
    document.querySelectorAll(".nav-link").forEach(l=>l.classList.remove("active"));
    link.classList.add("active");
  };
});

profileBtn.onclick = e => {
  e.stopPropagation();
  profileMenu.style.display =
    profileMenu.style.display === "block" ? "none" : "block";
};

document.addEventListener("click", ()=> profileMenu.style.display="none");

document.getElementById("notifBtn").onclick = ()=>{
  document.querySelector("iframe").src = "notification.html";
  document.getElementById("notifCount").style.display="none";
};
</script>

<!-- ================= FIREBASE DASHBOARD LOGIC ================= -->
<script type="module">
import { auth } from "./firebase-config.js";
import {
  onAuthStateChanged,
  signOut
} from "https://www.gstatic.com/firebasejs/12.7.0/firebase-auth.js";

const avatar = document.querySelector(".avatar");
const logoutLink = document.getElementById("logoutLink");

/* AUTH GUARD + PROFILE PHOTO */
onAuthStateChanged(auth, user => {
  if (!user) {
    window.top.location.href = "newindex.html";
    return;
  }

  if (user.photoURL) {
    avatar.src = user.photoURL;
  }
});

/* LOGOUT */
logoutLink.onclick = async (e) => {
  e.preventDefault();
  await signOut(auth);
  window.top.location.href = "newindex.html";
};
</script>

</body>
</html>
