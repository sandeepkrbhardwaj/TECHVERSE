<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Techverse | Create Account</title>

  <!-- ================= CSS ================= -->
  <style>
    /* RESET */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: Arial, sans-serif;
    }

    /* BODY */
    body {
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      background: #ffffff;
    }

    /* SIGNUP CARD */
    .signup-box {
      width: 100%;
      max-width: 440px;
      background: #ffffff;
      padding: 30px;
      border-radius: 16px;
      box-shadow: 0 18px 40px rgba(0, 0, 0, 0.15);
      animation: pop 0.35s ease;
    }

    @keyframes pop {
      from {
        transform: scale(0.9);
        opacity: 0;
      }
      to {
        transform: scale(1);
        opacity: 1;
      }
    }

    /* LOGO */
    .logo {
      display: flex;
      justify-content: center;
      margin-bottom: 18px;
    }

    .logo img {
      width: 105px;
      height: 85px;
      border-radius: 8px;
    }

    /* TITLE */
    h2 {
      text-align: center;
      margin-bottom: 6px;
      color: #0b3b6f;
    }

    p {
      text-align: center;
      font-size: 14px;
      color: #475569;
      margin-bottom: 22px;
      font-weight: 600;
    }

    /* INPUTS */
    input {
      width: 100%;
      padding: 12px;
      margin-bottom: 14px;
      border-radius: 10px;
      border: 1px solid #cbd5e1;
      font-size: 15px;
      outline: none;
    }

    input:focus {
      border-color: #135bec;
    }

    /* BUTTON */
    button {
      width: 100%;
      padding: 12px;
      border: none;
      border-radius: 10px;
      background: #135bec;
      color: white;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      transition: 0.2s;
    }

    button:hover {
      background: #0b3b6f;
    }

    /* EXTRA */
    .extra {
      margin-top: 16px;
      text-align: center;
      font-size: 14px;
      color: #475569;
    }

    .extra a {
      color: #135bec;
      font-weight: bold;
      text-decoration: none;
    }

    .extra a:hover {
      text-decoration: underline;
    }
  </style>
</head>

<body>

  <!-- ================= SIGNUP CARD ================= -->
  <div class="signup-box">

    <div class="logo">
      <img src="indexlogo.png" alt="Techverse Logo" />
    </div>

    <h2>Create Account ðŸš€</h2>
    <p>Join Techverse and start learning today</p>

    <!-- INPUTS -->
    <input type="text" id="name" placeholder="Full Name" />
    <input type="email" id="email" placeholder="Email Address" />
    <input type="password" id="password" placeholder="Password" />
    <input type="password" id="confirmPassword" placeholder="Confirm Password" />

    <!-- BUTTON -->
    <button onclick="signup()">Create Account</button>

    <div class="extra">
      Already have an account?
      <a href="newlogin.html">Login</a>
    </div>

  </div>

  <!-- ================= FIREBASE SIGNUP SCRIPT ================= -->
  <script type="module">
    /* ---------------------------------------------------------
       IMPORT FIREBASE AUTH
    --------------------------------------------------------- */
    import { auth } from "./firebase-config.js";
    import {
      createUserWithEmailAndPassword,
      updateProfile
    } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-auth.js";

    /* ---------------------------------------------------------
       SIGNUP FUNCTION (ONLY ONE, FINAL)
    --------------------------------------------------------- */
    window.signup = function () {
      const name = document.getElementById("name");
      const email = document.getElementById("email");
      const password = document.getElementById("password");
      const confirmPassword = document.getElementById("confirmPassword");

      /* VALIDATION */
      if (
        !name.value ||
        !email.value ||
        !password.value ||
        !confirmPassword.value
      ) {
        alert("Please fill all fields");
        return;
      }

      if (password.value.length < 6) {
        alert("Password must be at least 6 characters");
        return;
      }

      if (password.value !== confirmPassword.value) {
        alert("Passwords do not match");
        return;
      }

      /* FIREBASE CREATE USER */
      createUserWithEmailAndPassword(auth, email.value, password.value)
        .then((cred) => {
          /* SAVE USER NAME */
          return updateProfile(cred.user, {
            displayName: name.value
          });
        })
        .then(() => {
          /* SAFE REDIRECT FROM IFRAME */
          window.parent.postMessage(
            { type: "AUTH_SUCCESS" },
            "*"
          );
        })
        .catch((error) => {
          alert(error.message);
        });
    };
  </script>

</body>
</html>
